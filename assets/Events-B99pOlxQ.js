import{u as N,a as k,r as c,j as i,L as E,b as L,S as C,c as S}from"./index-2XpFjLe5.js";import{M as F}from"./index-Dt7lNvt8.js";import{f as I}from"./time-VhdYBW02.js";import{u as _}from"./useMutation-CjqBrlJR.js";import{u as z,f as M}from"./api-Cf-XEaLP.js";import{A as T}from"./Avatar-yBnmNMT9.js";import{F as P}from"./index-DlUR0cDl.js";import{u as A}from"./useQuery-FusMx-ux.js";import{H as Q}from"./Header-DTOTYiuL.js";import{I as q}from"./index-C8rWGDmY.js";import"./iconBase-BVy5283W.js";function w(s){return s>=1e9?(s/1e9).toFixed(1)+"B":s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s}const B=({event:s,toDisplay:o})=>{var h,f,p,j,g;const e=N(),{user:a}=k(),[d,m]=c.useState(!1),n=(h=s==null?void 0:s.likes)==null?void 0:h.includes(a==null?void 0:a._id),[l,t]=c.useState(0),r=(f=s==null?void 0:s.likes)==null?void 0:f.length;c.useEffect(()=>{m(n),t(r)},[s]);const{mutate:b}=_({mutationFn:()=>z(s==null?void 0:s._id),onMutate:async()=>{m(u=>!u),t(u=>d?u-1:u+1),await e.cancelQueries(["event",s==null?void 0:s._id])},onError:u=>{m(x=>!x),t(x=>d?x+1:x-1)},onSettled:()=>{e.invalidateQueries(["event",s==null?void 0:s._id])}}),y=()=>{b()};return i.jsxs("div",{className:"bg-[#1f1f1f] shadow-3xl rounded-lg overflow-hidden select-none",children:[i.jsx("div",{className:"relative h-64 sm:h-80 md:h-96 lg:h-[50vh] xl:h-[60vh] w-full",children:i.jsx(E,{to:`/events/${s==null?void 0:s._id}`,className:"w-full h-full",children:i.jsx("img",{src:(s==null?void 0:s.imageUrl)||"/api/placeholder/400/320",alt:(s==null?void 0:s.title)||"Event Image",className:"object-cover w-full h-full rounded-lg z-0"})})}),i.jsxs("div",{className:"p-4",children:[i.jsx("h1",{className:"text-xl font-semibold text-white mb-2 truncate",children:(s==null?void 0:s.title)||"Untitled Event"}),i.jsxs("div",{className:"text-sm text-gray-400 flex items-center justify-between mb-4",children:[s!=null&&s.paid?i.jsxs("span",{className:"bg-green-500 rounded-full px-2 text-white",children:["â‚¹",s==null?void 0:s.amount]}):i.jsx("span",{className:"bg-purple-500 rounded-full px-2 text-white",children:"Free"}),i.jsx("span",{children:I(s==null?void 0:s.createdAt)||"No date"})]}),o&&i.jsx("div",{className:"flex justify-between items-center mt-2 w-full text-white shadow-3xl",children:i.jsx("div",{className:"bg-zinc-600 rounded-lg p-4 w-full",children:i.jsxs("div",{className:"flex items-center justify-between w-full",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden",children:i.jsx(T,{size:"sm",imageUrl:(p=s==null?void 0:s.userId)==null?void 0:p.profile_image_url,name:(j=s==null?void 0:s.userId)==null?void 0:j.userName})}),i.jsx("div",{className:"text-white font-bold text-sm",children:(g=s==null?void 0:s.userId)==null?void 0:g.userName})]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{children:w(l)}),i.jsx("span",{className:"flex gap-1 text-lg font-semibold",children:i.jsx(P,{size:20,onClick:y,className:`cursor-pointer transition-colors duration-200 ${d?"text-red-500":"text-zinc-100"}`})})]}),i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{className:"font-semibold",children:w((s==null?void 0:s.comments)||0)}),i.jsx(F,{size:20})]})]})]})})})]})]})},D=()=>{const s=N(),o=L(),[e,a]=c.useState(1),{isLoading:d,isError:m,isSuccess:n,data:l}=A({queryKey:["events",e],queryFn:M,keepPreviousData:!0});if(n&&window.scrollTo({top:0,behavior:"smooth"}),c.useEffect(()=>{s.invalidateQueries(["events"])},[o==null?void 0:o.pathname,s]),d||m)return i.jsx("div",{className:"h-[90vh] flex justify-center items-center backdrop-blur-3xl",children:i.jsx(C,{})});const t=(l==null?void 0:l.events)||[];return i.jsxs("div",{className:"min-h-screen",children:[i.jsx("div",{className:"w-full mx-auto h-auto p-2 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-2",children:t==null?void 0:t.map(r=>i.jsx(B,{event:r,toDisplay:!0},r==null?void 0:r._id))}),i.jsxs("div",{className:"flex justify-center items-center pb-10 mx-auto mt-3 space-x-4 ",children:[i.jsx("button",{className:"px-2 py-1 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:opacity-50",onClick:()=>a(r=>Math.max(r-1,1)),disabled:e===1,children:"Previous"}),i.jsxs("span",{className:"text-white",children:["Page ",e," of ",l==null?void 0:l.totalPages]}),i.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:opacity-50",onClick:()=>a(r=>r+1),disabled:e>=(l==null?void 0:l.totalPages),children:"Next"})]})]})},H=()=>{const[s,o]=c.useState(!1);c.useEffect(()=>{const a=()=>{o(window.scrollY>300)};return window.addEventListener("scroll",a),()=>window.removeEventListener("scroll",a)},[]);const e=()=>{window.scrollTo({top:0,behavior:"smooth"})};return i.jsx(i.Fragment,{children:s&&i.jsx("button",{onClick:e,className:" fixed bottom-5 right-5 text-slate-700 bg-slate-300 rounded-full   transition-all",children:i.jsx(q,{size:35})})})},Z=()=>i.jsxs("div",{className:"w-full h-screen",children:[i.jsx(Q,{}),i.jsxs("section",{children:[i.jsx(D,{}),i.jsx(H,{})]}),i.jsx(S,{})]});export{Z as default};
